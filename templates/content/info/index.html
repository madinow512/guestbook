<script>
    quitAllAsyncIntervals();
</script>
<div class="absoluteElement horizontalAlignedElement autoHeightElement centeredContent smaller">
    <!--<div class="autoHeightElement overview"></div>-->

    <div class="autoWidthElement contentContainer">
        <h2>Das Gästebuch</h2>
        Diese Seite dient als Dokumentation des hier vorliegenden Studienprojektes.<br>
        Zunächst soll die Aufgabenstellung umrissen und das daraus resultierende Konzept vorgestellt werden.
        Anschließend werden die einzelnen Komponenten dieser Web-Applikation und deren technischen Details erläutert.
    </div>

    <div class="autoWidthElement contentContainer simple">
        <h3>Die Aufgabenstellung</h3>
        Im Rahmen des Praktikums der Veranstaltung <i>Verteilte Systeme</i> des Studienganges <i>Medien- und
        Kommunikationsinformatik</i> der Hochschule Reutlingen soll ein Gästebuch entwickelt werden, welches die Möglichkeit bietet, Beiträge zu
        lesen und  zu verfassen.<br>
        Um die verfassten Beiträge dauerhaft speichern zu können, soll eine MySQL-Datenbank verwendet, der Server in PHP
        implementiert und das Frontend unter Verwendung von HTML, JavaScript und CSS realisiert werden.
        Die Kommunikation zwischen Client und Server soll dabei basierend auf AJAX im JSON-Format erfolgen.
    </div>

    <div class="autoWidthElement contentContainer ">
        <h3>Das Konzept</h3>
        Dieses Gästebuch stellt eine sogenannte <i>Single-Page Applikation</i> dar. Die gesamte Navigation sowie sämtliche Aktionen
        laufen dabei innerhalb der Seite ab, ohne dass ein erneutes Laden der Seite erforderlich ist.
        Gesamt setzt sich die Seite aus drei Hauptelementen zusammen: Für die Navigation zwischen den einzelnen Seiteninhalten
        existiert eine Navigationsleiste am linken Rand. Die verschiedenen Inhalte werden im Hauptbereich in der Mitte
        der Seite dargestellt. Für alle weiteren Optionen und Aktionen wie beispielsweise die Registrierung oder die Anmeldung
        gibt es die sogenannte Sidebar, die sich vom rechten Rand der Seite her öffnet. Der Fokus bei diesem Entwurf liegt dabei auf
        der Benutzerfreundlichkeit: Es sollen immer nur die Inhalte angezeigt werden, die für den Benutzer gerade im Moment
        von Interesse sind - alles andere wird konsequent ausgeblendet!
        <br>
        Des Weiteren verfügt das Gästebuch über zwei unterschiedliche Bereiche. Im öffentlichen Bereich kann jeder Benutzer anonym unter
        Verwendung eines temporären Benutzernamens neue Beiträge verfassen. Beiträge in diesem Bereich können von jedem gelesen werden,
        der die Seite aufruft. Zum privaten Bereich haben dagegen lediglich registrierte Mitglieder Zugang. Beiträge in diesem Bereich können von
        nicht angemeldeten Benutzern nicht eingesehen werden. Für die Registrierung werden ein noch nicht verwendeter Benutzername sowie ein
        Passwort benötigt.<br>
    </div>

    <div class="autoWidthElement contentContainer ">
        <h3>Die Datenbank</h3>
        Die Datenbank besteht aus zwei Tabellen: Die Tabelle <i>users</i> beinhaltet alle Informationen über registrierte Mitglieder, wohingegen
        <i>content</i> der Speicherung aller verfassten Beiträge dient. Dabei werden sowohl Beiträge aus dem öffentlichen als auch solche aus
        dem privaten Bereich in dieser Tabelle abgelegt.
        <img src="../../../graphics/documentation/er.PNG">
        Die Unterscheidung, welchem Bereich ein Beitrag angehört, geschieht über die
        angehängten Benutzerinformationen. Da private Beiträge nur von registrierten Benutzern verfasst werden können, wird bei diesen
        eine gültige <i>User ID</i> in der Datenbank hinterlegt. Bei öffentlichen Beiträgen kann keine User ID gesetzt werden, da diese
        von anonymen Benutzern erstellt werden. Daher wird hier direkt der temporäre Benutzername des Erstellers gespeichert, die User ID wird
        auf den Wert <i>NULL</i> gesetzt.<br>
    </div>

    <div class="autoWidthElement contentContainer ">
        <h3>Der Server</h3>
        Die Dokumentation des Servers gliedert sich in die beiden Abschnitte <i>Datenbankanbindung</i> und <i>Schnittstellen</i> (Interfaces).
        Die nachfolgende Abbildung illustriert die grundlegende Architektur des Servers.
            <img src="../../../graphics/documentation/server2.png">
        <h4>Datenbankanbindung</h4>
        Der <i>DatabaseAdapter</i> dient der Anbindung an die Datenbank und basiert auf den <i>PHP Data Objects</i> (PDO). Anfragen an die Datenbank werden dabei
        über die Methode <i>exec()</i> in Form von <i>Prepared Statements</i> gesendet. Falls es sich um ein <i>SELECT</i> handelt, werden die
        resultierenden Zeilen aus der Datenbank in die entsprechende Klasse konvertiert, die als Parameter spezifiziert werden kann. Die nachfolgende Abbildung zeigt
        die Methoden zum Verbindungsaufbau und -abbau sowie die Methode für die Ausführung von Datenbankanfragen.
            <img src="../../../graphics/documentation/db1.PNG">
        Das <i>DatabaseModel</i> bildet die Daten aus der Datenbank in objekt-orientierter Form ab und dient als Grundlage für die
        Implementierung aller weiteren Datenmodelle wie zum Beispiel das <i>UserModel</i>. Ein <i>Model</i> verfügt für die Kommunikation mit der Datenbank über eine
        statische Instanz des DatabaseAdapters. Außerdem existieren Methoden zum Speichern und Aktualisieren des Models in der Datenbank. Beide Prozesse
        funktionieren dabei auf Grundlage von <i>Reflection</i>. Hierdurch kann auch auf Attribute, die erst dynamisch zur Laufzeit gesetzt werden,
        zugegriffen und diese so in der Datenbank gespeichert werden. Die nachfolgende Abbildung gibt einen Überblick über die eben beschriebenen Methoden.
        <img src="../../../graphics/documentation/db2.PNG">
        Alle weiteren Models erben vom DatabaseModel und nutzen die Methoden dieser Klasse. Abgesehen davon verfügt jedes Model über individuelle
        Getter und Setter für die einzelnen model-spezifischen Attribute.
        <h4>Schnittstellen</h4>
        Die Schnittstellen (Interfaces) dienen als Kommunikationspunkt zwischen Server und Client. Entsprechend der HTTP-Methode, den übergebenen Parametern und deren
        Gültigkeit werden die Anfragen des Frontends hier verarbeitet und Antworten im JSON-Format zurückgeschickt. Die nachfolgende Abbildung illustriert
        diese Funktionsweise anhand der Anmelde-Schnittstelle.
        <img src="../../../graphics/documentation/interface1.PNG">
        Zunächst wird das <i>initApplication</i>-Skript eingebunden. Dieses wird in jeder Schittstelle benötigt, um die <i>Application</i> und deren integrierten
        <i>Autoloader</i> nutzen zu können. Auf diese Weise muss ab diesem Zeitpunkt nicht mehr jedes verwendete Skript händisch eingebunden werden.
        Anschließend wird geprüft, ob es sich um die korrekte HTTP-Methode handelt und die erforderlichen Parameter alle gesetzt sind. Im Falle des Anmeldevorganges
        muss es sich um eine Anfrage via HTTP-Post handeln. Es werden der Benutzername und das Passwort benötigt. Sind diese korrekt eingegangen, wird überprüft, ob
        ein Benutzer mit dem angegebenen Benutzernamen existiert. Dies geschieht über den Aufruf der dafür zuständigen statischen Methode des <i>UserModels</i>.
        Existiert kein Benutzer mit diesem Namen, wird - wie in jedem anderen Fehlerfall - eine Antwort mit dem <i>HTTP-Statuscode</i> 400
        (client-seitiger Fehler, zum Beispiel durch fehlerhafte Eingabe) und einer optionalen Fehlermeldung an den Client zurückgesendet.
        Ist der Benutzer dem System bekannt, wird das dazugörige UserModel geladen und das eingegebene Passwort mit dem in der Datenbank hinterlegten verglichen.
        Selbstverständlich erfolgt dies in verschlüsselter Form. Zuständig für die Verschlüsselung und die Prüfung verschlüsselter Passwörter ist die
        statische Klasse <i>PassHash</i>. War die Passworteingabe ebenfalls korrekt, so hat sich der Benutzer erfolgreich angemeldet. Der Zeitpunkt der
        letzten Anmeldung wird in der Datenbank aktualisiert und die <i>Session</i> des Benutzers aktiviert. Im letzten Schritt wird eine Willkommensnachricht
        mit dem Statuscode 200 an den Client gesendet. Alle anderen Schnittstellen funktionieren auf dieselbe Weise. <br>
        Nachfolgend wird noch kurz die Methode illustriert, die die HTTP-Antworten im JSON-Format an den Client sendet. Diese befindet sich im Modul
        <i>Core</i>.
        <img src="../../../graphics/documentation/interface2.PNG">
    </div>

    <div class="autoWidthElement contentContainer simple">
        <h3>Der Client</h3>
    </div>
</div>